<div class="slidenav-overlay" [ngClass]="{'overlay-background' : isSidebarOpen, 'slidenav-overlay-top' : isUnreadWindowOpen}"
  *ngIf="isSidebarOpen || isDropMenuOpen || isShowSearchResults" (click)="ClosePopups()"></div>
<div id="navbar">
  <div class="navbar-container">
    <div id="sidenav" class="sidenav" [ngClass]="{'sidenav-shadow' : isSidebarOpen}">
      <div class="slidenav-head-sector">
        <div class="slidenav-header">
          <profilePicture class="profile-picture" [isEditEnable]="true"></profilePicture>
          <div class="user-name" title="{{user.firstName + ' ' + user.lastName}}">{{user.firstName + " " + user.lastName}}</div>
          <div class="toolbar-menu">
            <span class="toolbar-item" *ngFor="let item of toolbarItems">
              <i title="{{item.title}}" (click)="item.onClick()" class="{{item.icon}}" aria-hidden="true"></i>
              <span class="badget-icon" *ngIf="IsShowToolbarItemBadget(item)"></span>
            </span>
          </div>
        </div>
      </div>
      <div class="slidenav-body-sector">
        <loader id="friends-loader" class="friends-loader" *ngIf="isFriendsLoading"></loader>
        <div id="friends-sector" class="friends-sector" *ngIf="!isFriendsLoading && friends.length > 0">
          <form class="form-horizontal" *ngIf="IsShowFriendFindInput()">
            <div class="form-group">
              <div id="friend-search-container" class="col-md-12">
                <input [(ngModel)]="friendSearchInput" id="friend-search" name="friend-search" class="form-control" type="text" placeholder="חיפוש חברים"
                  autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
              </div>
            </div>
          </form>
          <div (click)="OpenChat(friend)" class="friend-container" *ngFor="let friend of (GetFilteredFriends(friendSearchInput))">
            <div *ngIf="friend.isOnline && isSidebarOpen" class="online-icon"></div>
            <img class="friend-profile" src="{{friend.profileImage ? friend.profileImage : defaultProfileImage}}">
            <span [ngClass]="{'bold-friend-name' : GetFriendUnreadMessagesNumberText(friend._id)}" class="friend-name-container" title="{{friend.firstName + ' ' + friend.lastName}}">
              <span>{{friend.firstName + " " + friend.lastName}}</span>
            <span>{{GetFriendUnreadMessagesNumberText(friend._id)}}</span>
            </span>
          </div>
        </div>
        <div *ngIf="!isFriendsLoading && friends.length == 0 && isSidebarOpen" class="no-friends-container">
          <i class="material-icons no-friends-icon">people</i>
        </div>
      </div>
    </div>
    <div class="container-fluid navbar">
      <div class="col-xs-8 navbar-right-container">
        <img (click)="ShowHideSidenav()" src="../logo/icon.png" class="head-icon">
        <span class="search-sector col-md-6 col-xs-9">
        <input type="text" class="search-input" placeholder="חיפוש" [(ngModel)]="searchInput" (ngModelChange)="SearchChange(searchInput)" (focus)="ClickSearchInput(searchInput)" 
        autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
        <span class="glyphicon glyphicon-search search-icon" [ngClass]="{'search-icon-active':isShowSearchResults && GetFilteredSearchResults(searchInput).length > 0}"></span>
        <div class="search-results-container" *ngIf="isShowSearchResults && GetFilteredSearchResults(searchInput).length > 0">
          <div class="search-result" *ngFor="let result of GetFilteredSearchResults(searchInput)" title="{{result.fullName}}">
            <img *ngIf="result.profile && result.profile != -1" src="{{result.profile}}" class="search-result-image">
            <img *ngIf="!result.profile" src="/app/components/profilePicture/pictures/empty-profile.png" class="search-result-image">
            <span *ngIf="result.profile == -1" class="search-result-image-loading">
              <p class="load-image-icon"><i class="fa fa-circle" aria-hidden="true"></i> <i class="fa fa-circle" aria-hidden="true"></i> <i class="fa fa-circle" aria-hidden="true"></i></p>
            </span>
            <span class="search-result-name">{{result.fullName}}</span>
            <i *ngIf="result._id != user._id" class="fa fa-plus-square-o friend-request-btn hvr-grow" title="בקשת חברות" aria-hidden="true"></i>
          </div>
        </div>
        <i class="fa fa-bell-o notification-icon" aria-hidden="true"></i>
        <span class="notification-icon-badget" *ngIf="false"></span>
        </span>
      </div>
      <div style="float:left;" class="col-xs-4">        
        <div *ngIf="user" class="manage-sector">
          <span (click)="ShowHideDropMenu()" class="glyphicon glyphicon-triangle-bottom menu-icon"></span>
          <span (click)="ShowHideDropMenu()" class="name">
            <span class="top-navbar-user-image">
              <profilePicture [isEditEnable]="false"></profilePicture>
            </span>
            {{user.firstName}}
          </span>
          <span class="glyphicon glyphicon-triangle-top menu-top-arrow" *ngIf="isDropMenuOpen"></span>
          <dropMenu class="dropMenuPosition col-md-2 col-xs-4" *ngIf="isDropMenuOpen" [options]="dropMenuDataList"></dropMenu>
        </div>
      </div>
    </div>
  </div>
  <span (click)="MessageNotificationClicked()" id="message-notification" class="message-notification" *ngIf="isShowMessageNotification">
    <span class="message-notification-name">{{messageNotificationName}}</span>: <span class="message-notification-text">{{messageNotificationText}}</span>
  </span>
</div>

<unreadWindow *ngIf="isUnreadWindowOpen" [OpenChat]="OpenChat.bind(this)" [friends]="friends" [messagesNotifications]="GetToolbarItem('messages').content"></unreadWindow>
<chat *ngIf="chatData.isOpen" [chatData]="chatData"></chat>